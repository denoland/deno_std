// Copyright 2018-2024 the Deno authors. All rights reserved. MIT license.

const CHAR_MAP = new Map([
  ["$", "dollar"],
  ["%", "percent"],
  ["&", "and"],
  ["<", "less"],
  [">", "greater"],
  ["|", "or"],
  ["¢", "cent"],
  ["£", "pound"],
  ["¤", "currency"],
  ["¥", "yen"],
  // ["@", "at"],
  ["©", "(c)"],
  ["ª", "a"],
  ["®", "(r)"],
  ["º", "o"],
  ["Æ", "AE"],
  ["Ð", "D"],
  ["Ø", "O"],
  ["Þ", "TH"],
  ["ß", "ss"],
  ["æ", "ae"],
  ["ð", "d"],
  ["ø", "o"],
  ["þ", "th"],
  ["Đ", "DJ"],
  ["đ", "dj"],
  ["Ę", "e"],
  ["Ī", "i"],
  ["ı", "i"],
  ["Ķ", "k"],
  ["Ł", "L"],
  ["ł", "l"],
  ["Œ", "OE"],
  ["œ", "oe"],
  ["Ū", "u"],
  ["Ə", "E"],
  ["ƒ", "f"],
  ["ǈ", "LJ"],
  ["ǉ", "lj"],
  ["ǋ", "NJ"],
  ["ǌ", "nj"],
  ["ə", "e"],
  ["˚", "o"],
  ["Ά", "A"],
  ["Έ", "E"],
  ["Ή", "H"],
  ["Ί", "I"],
  ["Ό", "O"],
  ["Ύ", "Y"],
  ["Ώ", "W"],
  ["ΐ", "i"],
  ["Α", "A"],
  ["Β", "B"],
  ["Γ", "G"],
  ["Δ", "D"],
  ["Ε", "E"],
  ["Ζ", "Z"],
  ["Η", "H"],
  ["Θ", "8"],
  ["Ι", "I"],
  ["Κ", "K"],
  ["Λ", "L"],
  ["Μ", "M"],
  ["Ν", "N"],
  ["Ξ", "3"],
  ["Ο", "O"],
  ["Π", "P"],
  ["Ρ", "R"],
  ["Σ", "S"],
  ["Τ", "T"],
  ["Υ", "Y"],
  ["Φ", "F"],
  ["Χ", "X"],
  ["Ψ", "PS"],
  ["Ω", "W"],
  ["Ϊ", "I"],
  ["Ϋ", "Y"],
  ["ά", "a"],
  ["έ", "e"],
  ["ή", "h"],
  ["ί", "i"],
  ["ΰ", "y"],
  ["α", "a"],
  ["β", "b"],
  ["γ", "g"],
  ["δ", "d"],
  ["ε", "e"],
  ["ζ", "z"],
  ["η", "h"],
  ["θ", "8"],
  ["ι", "i"],
  ["κ", "k"],
  ["λ", "l"],
  ["μ", "m"],
  ["ν", "n"],
  ["ξ", "3"],
  ["ο", "o"],
  ["π", "p"],
  ["ρ", "r"],
  ["ς", "s"],
  ["σ", "s"],
  ["τ", "t"],
  ["υ", "y"],
  ["φ", "f"],
  ["χ", "x"],
  ["ψ", "ps"],
  ["ω", "w"],
  ["ϊ", "i"],
  ["ϋ", "y"],
  ["ό", "o"],
  ["ύ", "y"],
  ["ώ", "w"],
  ["Ё", "Yo"],
  ["Ђ", "DJ"],
  ["Є", "Ye"],
  ["І", "I"],
  ["Ї", "Yi"],
  ["Ј", "J"],
  ["Љ", "LJ"],
  ["Њ", "NJ"],
  ["Ћ", "C"],
  ["Џ", "DZ"],
  ["А", "A"],
  ["Б", "B"],
  ["В", "V"],
  ["Г", "G"],
  ["Д", "D"],
  ["Е", "E"],
  ["Ж", "Zh"],
  ["З", "Z"],
  ["И", "I"],
  ["Й", "J"],
  ["К", "K"],
  ["Л", "L"],
  ["М", "M"],
  ["Н", "N"],
  ["О", "O"],
  ["П", "P"],
  ["Р", "R"],
  ["С", "S"],
  ["Т", "T"],
  ["У", "U"],
  ["Ф", "F"],
  ["Х", "H"],
  ["Ц", "C"],
  ["Ч", "Ch"],
  ["Ш", "Sh"],
  ["Щ", "Sh"],
  ["Ъ", "U"],
  ["Ы", "Y"],
  ["Ь", ""],
  ["Э", "E"],
  ["Ю", "Yu"],
  ["Я", "Ya"],
  ["а", "a"],
  ["б", "b"],
  ["в", "v"],
  ["г", "g"],
  ["д", "d"],
  ["е", "e"],
  ["ж", "zh"],
  ["з", "z"],
  ["и", "i"],
  ["й", "j"],
  ["к", "k"],
  ["л", "l"],
  ["м", "m"],
  ["н", "n"],
  ["о", "o"],
  ["п", "p"],
  ["р", "r"],
  ["с", "s"],
  ["т", "t"],
  ["у", "u"],
  ["ф", "f"],
  ["х", "h"],
  ["ц", "c"],
  ["ч", "ch"],
  ["ш", "sh"],
  ["щ", "sh"],
  ["ъ", "u"],
  ["ы", "y"],
  ["ь", ""],
  ["э", "e"],
  ["ю", "yu"],
  ["я", "ya"],
  ["ё", "yo"],
  ["ђ", "dj"],
  ["є", "ye"],
  ["і", "i"],
  ["ї", "yi"],
  ["ј", "j"],
  ["љ", "lj"],
  ["њ", "nj"],
  ["ћ", "c"],
  ["ѝ", "u"],
  ["џ", "dz"],
  ["Ґ", "G"],
  ["ґ", "g"],
  ["Ғ", "GH"],
  ["ғ", "gh"],
  ["Қ", "KH"],
  ["қ", "kh"],
  ["Ң", "NG"],
  ["ң", "ng"],
  ["Ү", "UE"],
  ["ү", "ue"],
  ["Ұ", "U"],
  ["ұ", "u"],
  ["Һ", "H"],
  ["һ", "h"],
  ["Ә", "AE"],
  ["ә", "ae"],
  ["Ө", "OE"],
  ["ө", "oe"],
  ["Ա", "A"],
  ["Բ", "B"],
  ["Գ", "G"],
  ["Դ", "D"],
  ["Ե", "E"],
  ["Զ", "Z"],
  ["Է", "E'"],
  ["Ը", "Y'"],
  ["Թ", "T'"],
  ["Ժ", "JH"],
  ["Ի", "I"],
  ["Լ", "L"],
  ["Խ", "X"],
  ["Ծ", "C'"],
  ["Կ", "K"],
  ["Հ", "H"],
  ["Ձ", "D'"],
  ["Ղ", "GH"],
  ["Ճ", "TW"],
  ["Մ", "M"],
  ["Յ", "Y"],
  ["Ն", "N"],
  ["Շ", "SH"],
  ["Չ", "CH"],
  ["Պ", "P"],
  ["Ջ", "J"],
  ["Ռ", "R'"],
  ["Ս", "S"],
  ["Վ", "V"],
  ["Տ", "T"],
  ["Ր", "R"],
  ["Ց", "C"],
  ["Փ", "P'"],
  ["Ք", "Q'"],
  ["Օ", "O''"],
  ["Ֆ", "F"],
  ["և", "EV"],
  ["ء", "a"],
  ["آ", "aa"],
  ["أ", "a"],
  ["ؤ", "u"],
  ["إ", "i"],
  ["ئ", "e"],
  ["ا", "a"],
  ["ب", "b"],
  ["ة", "h"],
  ["ت", "t"],
  ["ث", "th"],
  ["ج", "j"],
  ["ح", "h"],
  ["خ", "kh"],
  ["د", "d"],
  ["ذ", "th"],
  ["ر", "r"],
  ["ز", "z"],
  ["س", "s"],
  ["ش", "sh"],
  ["ص", "s"],
  ["ض", "dh"],
  ["ط", "t"],
  ["ظ", "z"],
  ["ع", "a"],
  ["غ", "gh"],
  ["ف", "f"],
  ["ق", "q"],
  ["ك", "k"],
  ["ل", "l"],
  ["م", "m"],
  ["ن", "n"],
  ["ه", "h"],
  ["و", "w"],
  ["ى", "a"],
  ["ي", "y"],
  ["", "an"],
  ["", "on"],
  ["", "en"],
  ["", "a"],
  ["", "u"],
  ["", "e"],
  ["٠", "0"],
  ["١", "1"],
  ["٢", "2"],
  ["٣", "3"],
  ["٤", "4"],
  ["٥", "5"],
  ["٦", "6"],
  ["٧", "7"],
  ["٨", "8"],
  ["٩", "9"],
  ["پ", "p"],
  ["چ", "ch"],
  ["ژ", "zh"],
  ["ک", "k"],
  ["گ", "g"],
  ["ی", "y"],
  ["۰", "0"],
  ["۱", "1"],
  ["۲", "2"],
  ["۳", "3"],
  ["۴", "4"],
  ["۵", "5"],
  ["۶", "6"],
  ["۷", "7"],
  ["۸", "8"],
  ["۹", "9"],
  ["฿", "baht"],
  ["ა", "a"],
  ["ბ", "b"],
  ["გ", "g"],
  ["დ", "d"],
  ["ე", "e"],
  ["ვ", "v"],
  ["ზ", "z"],
  ["თ", "t"],
  ["ი", "i"],
  ["კ", "k"],
  ["ლ", "l"],
  ["მ", "m"],
  ["ნ", "n"],
  ["ო", "o"],
  ["პ", "p"],
  ["ჟ", "zh"],
  ["რ", "r"],
  ["ს", "s"],
  ["ტ", "t"],
  ["უ", "u"],
  ["ფ", "f"],
  ["ქ", "k"],
  ["ღ", "gh"],
  ["ყ", "q"],
  ["შ", "sh"],
  ["ჩ", "ch"],
  ["ც", "ts"],
  ["ძ", "dz"],
  ["წ", "ts"],
  ["ჭ", "ch"],
  ["ხ", "kh"],
  ["ჯ", "j"],
  ["ჰ", "h"],
  ["ẞ", "SS"],
  ["–", "-"],
  ["‘", "'"],
  ["’", "'"],
  ["“", '"'],
  ["”", '"'],
  ["„", '"'],
  ["†", "+"],
  ["•", "*"],
  ["…", "..."],
  ["₠", "ecu"],
  ["₢", "cruzeiro"],
  ["₣", "french franc"],
  ["₤", "lira"],
  ["₥", "mill"],
  ["₦", "naira"],
  ["₧", "peseta"],
  ["₨", "rupee"],
  ["₩", "won"],
  ["₪", "new shequel"],
  ["₫", "dong"],
  ["€", "euro"],
  ["₭", "kip"],
  ["₮", "tugrik"],
  ["₯", "drachma"],
  ["₰", "penny"],
  ["₱", "peso"],
  ["₲", "guarani"],
  ["₳", "austral"],
  ["₴", "hryvnia"],
  ["₵", "cedi"],
  ["₸", "kazakhstani tenge"],
  ["₹", "indian rupee"],
  ["₺", "turkish lira"],
  ["₽", "russian ruble"],
  ["₿", "bitcoin"],
  ["℠", "sm"],
  ["™", "tm"],
  ["∂", "d"],
  ["∆", "delta"],
  ["∑", "sum"],
  ["∞", "infinity"],
  ["♥", "love"],
  ["元", "yuan"],
  ["円", "yen"],
  ["﷼", "rial"],
  ["ﻵ", "laa"],
  ["ﻷ", "laa"],
  ["ﻹ", "lai"],
  ["ﻻ", "la"],
]);

function replaceChars(string: string) {
  return string
    .split("")
    .map((char) => CHAR_MAP.get(char) ?? char)
    .join("");
}

/**
 * Converts a string into a slug.
 *
 * @example Usage
 * ```ts
 * import { slugify } from "@std/text/slugify";
 * import { assertEquals } from "@std/assert";
 *
 * assertEquals(slugify("déjà vu"),"deja-vu");
 * ```
 *
 * @param input The string that is going to be converted into a slug
 * @returns The string as a slug
 */
export function slugify(input: string): string {
  return replaceChars(input)
    .trim()
    .toLowerCase()
    .normalize("NFD")
    .replaceAll(/\p{Diacritic}/gu, "")
    .replaceAll(/^-+|-+$/g, "")
    .replaceAll(/[^a-zA-Z0-9\s-]/g, "")
    .replaceAll(/\s+/g, "-")
    .replaceAll(/-+/g, "-");
}
